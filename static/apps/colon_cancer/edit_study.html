<section ng-if="!checkPermitted(study, active_user) && !loading">You can not access this page</section>
<section ng-if="checkPermitted(study, active_user)">
    <div class='panel panel-default'>
        <div class='panel-body'>
            <a href='#/problem/{{ colon_cancer.problem.id }}'><b> Back to problem page </b></a>
        </div><!-- End of Panel Body -->
    </div>

    <div class='panel panel-default'>
        <div class='panel-heading'>
            Edit Study
        </div>
        <div class='panel-body'>
            <form>
                <div class='form-group'>
                    <label> Finding </label>
                    <select title="" class='form-control'
                            ng-model="study.finding"
                            ng-change="update_results(study.finding);">
                        <option ng-repeat="finding in findings"
                                value="{{ finding }}"> {{ finding }}
                        </option>
                    </select>
                </div>
                <div class='form-group'>
                    <label> Result </label>
                    <select title="" class='form-control'
                            ng-model="study.result">
                        <option ng-repeat="result in results"
                                value="{{ result }}"
                                ng-selected="study.result === result"> {{ result }}
                        </option>
                    </select>
                </div>
                <div class='form-group'>
                    <label> Date </label>
                    <input title="" type='text' class='form-control' ng-model='study.study_date' id="due_date">
                </div>
                <div class='form-group'>
                    <label> Note </label>
                    <textarea title="" class='form-control' ng-model='study.note'></textarea>
                </div>
                <button ng-click="saveStudy(study)" type='submit' class='btn btn-primary float-right'>Save</button>
            </form>
        </div><!-- End of Panel Body -->
    </div>

    <div class='panel panel-default'>
        <div class='panel-heading'>
            Images
            <button class='btn btn-primary' ngf-select="open_image_upload_box($files)" multiple ngf-max-files="5"
                    accept="image/*"> Upload
            </button>
        </div>

        <div class='panel-body' ng-show="study.study_images.length > 0">
            <div masonry="{ gutter: 10}">
                <div class="masonry-brick" ng-repeat='image in study.study_images track by $index'>
                    <i class="fa fa-times" title="Delete image" ng-click='delete_study_image(image)'></i>
                    <a class="problem-images-gallery" rel="problem-images-gallery" href='{{ image.image }}'
                       fancyboxable="img-{{$index}}" id="img-{{$index}}">
                        <img ng-src='{{ image.image }}' load-images="true" alt="img-{{$index}}"/>
                    </a>
                </div>
            </div>
        </div>

    </div>
</section>